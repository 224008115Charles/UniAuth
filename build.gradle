allprojects {
    group = 'com.dianrong.common.uniauth'
    version = '1.0-SNAPSHOT'

    apply plugin: 'java'
    apply plugin: 'idea'
    apply plugin: 'eclipse'
    apply plugin: 'maven-publish'

    repositories {
        maven {
            url 'http://archiva.dianrong.com/repository/mirror'
        }
        maven {
            url 'http://archiva.dianrong.com/repository/internal'
        }
        maven {
            url 'http://archiva.dianrong.com/repository/snapshots'
        }
    }

    repositories{
		mavenCentral()
	}
	
    publishing {
        repositories {
            maven {
                url 'http://archiva.dianrong.com/repository/mirror'
                credentials {
                    username = 'developer'
                    password = '#a1GiRoKJnG'
                }
            }
            maven {
                url 'http://archiva.dianrong.com/repository/internal'
                credentials {
                    username = 'developer'
                    password = '#a1GiRoKJnG'
                }
            }
            maven {
                url 'http://archiva.dianrong.com/repository/snapshots'
                credentials {
                    username = 'developer'
                    password = '#a1GiRoKJnG'
                }
            }
        }
    }

    compileJava.options.encoding = 'UTF-8'
    compileTestJava.options.encoding = 'UTF-8'

    sourceCompatibility = 1.7
    targetCompatibility = 1.7
    
    configurations.all {
    	resolutionStrategy.cacheChangingModulesFor 60, 'seconds'
	}
	dependencies {
		//Test Suite
    	testCompile 'junit:junit:4.12'
	}

}

//task wrapper(type: Wrapper) {
//    gradleVersion = '2.6'
//    archiveBase = 'PROJECT'
//    archivePath = 'gradle/dists'
//}

project(':common') {
	dependencies {
		compile 'org.apache.commons:commons-lang3:3.4'
		compile 'com.google.guava:guava:18.0'
	}
}

project(':client') {
	dependencies {
		compile project(":common")
	    compile 'com.dianrong.loanbusiness.uniauth:loanbusiness-uniauth-client:1.0.27-SNAPSHOT'
	    compile 'org.apache.curator:curator-recipes:2.9.1'
	    compile 'org.springframework.security:spring-security-web:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-config:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-core:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-remoting:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-ldap:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-acl:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-cas:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-openid:4.0.3.RELEASE'
		compile 'org.springframework.security:spring-security-taglibs:4.0.3.RELEASE'
	}

    jar {
        baseName = 'common-uniauth-client'
    }


    task sourceJar(type: Jar) {
        from sourceSets.main.allJava
    }

    publishing {
        publications {
            client(MavenPublication) {
                artifactId 'common-uniauth-client'
                from components.java
                artifact sourceJar {
                    classifier "sources"
                }
            }
        }
    }
}

project(':subsystem') {
	apply plugin: 'war'
	
	dependencies {
	    compile project(":client")
	    providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
	    compile 'org.springframework:spring-webmvc:4.2.2.RELEASE'
	     
	}
	configurations{
    	runtime.exclude group : 'commons-logging',module:'commons-logging'
	}
	
	war {
    	archiveName = project.name + '.war'
	}
}

project(':cashelper') {
	dependencies {
		compile project(":common")
		compile('org.jasig.cas:cas-server-support-jdbc:3.5.2.1') {
			transitive = true
			exclude group: 'javax.xml', module: 'xmldsig'
		}
	}
}
