<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dianrong.common.uniauth.server.data.mapper.GrpPathMapper">

    <insert id="insertNewNode" parameterType="com.dianrong.common.uniauth.server.data.entity.GrpPath" >
        INSERT INTO grp_path (ancestor, descendant, deepth)
        SELECT t.ancestor, #{descendant,jdbcType=INTEGER}, t.deepth+1
        FROM grp_path AS t
        WHERE t.descendant = #{ancestor,jdbcType=INTEGER}
        UNION ALL
        SELECT #{descendant,jdbcType=INTEGER}, #{descendant,jdbcType=INTEGER}, 0;
    </insert>

</mapper>